# EY Finance Backend

A minimal Spring Boot (Java 17) backend for recording financing transactions using PostgreSQL.

## Tech Stack
- Java 17
- Spring Boot 3.5 (Web, Data JPA, Security)
- PostgreSQL
- Maven Wrapper

## Features
- Save a financing transaction with auto-increment `id`
- Fields: `amount`, `type`, `description`
- Open security configuration allowing all requests (CSRF disabled) for ease of local development

## Project Structure
- `com.eyfinance.backend.BackendApplication` — Application entry point
- `com.eyfinance.backend.entity.FinanceTransaction` — JPA entity mapped to table `transactions`
- `com.eyfinance.backend.repository.FinanceTransactionRepository` — Spring Data JPA repository
- `com.eyfinance.backend.controller.TransactionController` — REST controller exposing `/transaction/save`
- `src/main/resources/application.yml` — Application configuration (PostgreSQL + JPA)

## Prerequisites
- Java 17 installed
- PostgreSQL 14+ (or Docker)

If you prefer Docker to run PostgreSQL locally:
```bash
# Run Postgres locally via Docker
docker run --name eyfinance-postgres \
  -e POSTGRES_PASSWORD=root \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_DB=homeFinanceDB \
  -p 5432:5432 -d postgres:16
```

## Configuration
Application defaults are set in `src/main/resources/application.yml`:

```yaml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/homeFinanceDB
    username: postgres
    password: root
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    database-platform: org.hibernate.dialect.PostgreSQLDialect
  security:
    user:
      name: user
      password: password
```

You can override any of these with environment variables at runtime, for example:
```bash
export SPRING_DATASOURCE_URL="jdbc:postgresql://localhost:5432/homeFinanceDB"
export SPRING_DATASOURCE_USERNAME=postgres
export SPRING_DATASOURCE_PASSWORD=root
```

## Build
```bash
# From the project root
./mvnw -DskipTests package
```

## Run
```bash
# Run the Spring Boot application
./mvnw spring-boot:run
# or
java -jar target/backend-0.0.1-SNAPSHOT.jar
```

The app will start on `http://localhost:8080`.

## API

### Save Transaction
- Method: `POST`
- Path: `/transaction/save`
- Description: Persists a financing transaction and returns the saved record with generated `id`.

Request body:
```json
{
  "amount": 1250.50,
  "type": "INCOME",
  "description": "Salary"
}
```

Response 200 OK:
```json
{
  "id": 1,
  "amount": 1250.50,
  "type": "INCOME",
  "description": "Salary"
}
```

Curl example:
```bash
curl -X POST http://localhost:8080/transaction/save \
  -H "Content-Type: application/json" \
  -d '{
    "amount": 1250.50,
    "type": "INCOME",
    "description": "Salary"
  }'
```

Notes:
- `id` is generated by the database using IDENTITY strategy.
- `amount` uses `DECIMAL(19,2)` mapping.
- No authentication is required in the current configuration.

## Entities
- `FinanceTransaction`
  - `id: Long` (auto-increment primary key)
  - `amount: BigDecimal` (required)
  - `type: String` (required, up to 50 chars)
  - `description: String` (optional, up to 255 chars)

## Development Notes
- Security is configured to allow all requests and CSRF is disabled for local development (`SecurityConfig`). Adjust before production use.
- JPA `ddl-auto: update` is convenient for development. Consider migrations (e.g., Flyway) for production.

## Troubleshooting
- Connection refused to Postgres:
  - Ensure PostgreSQL is running and accessible at the URL in `application.yml`.
  - Verify credentials and network access (e.g., `psql` can connect).
- Build fails due to Java version:
  - Ensure your `JAVA_HOME` points to a Java 17 installation.
- Port conflicts:
  - If `8080` is in use, change `server.port` via environment variable or `application.yml`.

## License
This project is intended as a sample and does not include a specific license. Add one if needed for your use case.
